<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Allerta+Stencil">
	<link rel="stylesheet" href="../css/css.css">
	<title></title>
</head>

	<body>
		<div class="w3-container">

			<input type="submit" value="GET DATA FROM LOCAL" id="getLocalData" class="w3-btn w3-white w3-border w3-border-blue w3-margin">
			<input type="submit" value="GET DATA FROM API" id="getAPIDapa" class="w3-btn w3-blue w3-margin">
			<p id="result"></p>
		</div>

		<script>
			<!-- event binders -->
			document.getElementById('getLocalData').addEventListener('click', getLocalData);
			document.getElementById('getAPIDapa').addEventListener('click', getAPIDapa);

			const restUrl  = '../mocks/sampleUser.json';
			const restAPI = 'https://jsonplaceholder.typicode.com/users';

			const path = 'https://api.themoviedb.org/3/movie/550?',
						key = 'api_key=b25196cb6ea1946dc9e8fd6c3ddbe0a9',
						options = '&sort_by=vote_average.desc',
						extraOptions = '&include_video=true',
						provider = '&query=';
			const url = path + key + options + extraOptions;
			console.log('url :', url);


			function template(result, user) {
					if (!!user['name']) {
						console.table(user);
						const { id, name, email, address: { city, street } } = user;

						result +=
							`<div>
	             <h5> User ID: ${id} </h5>
	             <ul class="w3-ul">
	                 <li> User Full Name : ${name}</li>
	                 <li> User Email : ${email} </li>
	                 <li> User Address : ${city}, ${street} </li>
	             </ul>
	          </div>`;
						document.getElementById('result').innerHTML = result;
					}  else {
							html += '<div class="col"><h2>Not values found</h2></div>';
					}
			}

			async function getLocalData() {
				await fetch (restUrl)
					.then (function (res) {
						console.table (res);
						return res.json ();
					})
					.then (function (data) {
						let result = `<h2> User Info From sampleUser.json </h2>`;

						data.forEach ((user) => {
							const {id, name, email} = user;
							result +=
								`<div>
                <h5> User ID: ${id} </h5>
                <ul class="w3-ul">
                    <li> User Name : ${name}</li>
                    <li> User Email: ${email} </li>
                </ul>
            </div>`;

							document.getElementById ('result').innerHTML = result;
						});
					})
			}

			async function getAPIDapa(){
				await fetch(restAPI)
					.then((res) => {
						const contentType = res.headers.get( 'content-type' );
						const totalCount  = res.headers.get( 'x-wp-total' );
						const pages       = res.headers.get( 'x-wp-totalpages' );

						if ( contentType && contentType.includes( 'application/json' ) ) {
							console.table(res);
							return res.json()
						}
						throw new TypeError( 'Format is not standart JSON.' );
					})
					.then((data) => {
						let result = `<h2> Random User Info From Jsonplaceholder API</h2>`;

						data.forEach((user) => {
							template(result, user)
						});
					})
			}
		</script>

	</body>

</html>
